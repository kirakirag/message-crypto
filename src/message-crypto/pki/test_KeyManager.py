import unittest

from pki import KeyManager

keys = KeyManager.KeyManager()

KEY = '''-----BEGIN PGP PUBLIC KEY BLOCK-----

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
=s8pm
-----END PGP PUBLIC KEY BLOCK-----'''

class KeyManagerTest(unittest.TestCase):
    def test_key_import(self):
        self.assertEqual(keys.import_key(KEY), 'ok')

    def test_key_delete(self):
        self.assertEqual(keys.delete_key('B69E3EAA900DF1718119A42FF4C5F2E2F9FB9FCE'), 'ok')
        self.assertTrue('B69E3EAA900DF1718119A42FF4C5F2E2F9FB9FCE' not in keys.gpg.list_keys())


if __name__ == "__main__":
    unittest.main()